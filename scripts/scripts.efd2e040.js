"use strict";angular.module("ngQueensApp",["ngAnimate","ngCookies"]),angular.module("ngQueensApp").controller("MainController",["$scope",function(a){var b=this;b.currentGrid=4,b.moves,b.cols,b.rows,b.redBlocks,b.gridSizes=[{name:"4x4",value:4},{name:"5x5",value:5},{name:"6x6",value:6},{name:"7x7",value:7},{name:"8x8",value:8}],b.getNumber=function(a){for(var b=[],c=1;a>=c;c++)b.push(c);return b},b.changeGridSize=function(a){b.currentGrid=a,b.newGame(),localStorage.setItem("gridSize",a)},b.newGame=function(){var a,c;for(b.cols=new Array(b.currentGrid),b.rows=new Array(b.currentGrid),b.init_redBlocks(b.currentGrid),a=0;a<b.currentGrid;a++)for(b.cols[a]=0,b.rows[a]=0,c=0;c<b.currentGrid;c++)b.redBlocks[b.currentGrid*a+c]=0;b.moves=0,localStorage.setItem("moves",b.moves),localStorage.setItem("cols",b.cols),localStorage.setItem("rows",b.rows)},b.init_redBlocks=function(a){var c,d=a*a;for(b.redBlocks=new Array(d),c=0;d>c;c++)b.redBlocks[c]=0},b.moveQueen=function(a){var c,d,e=a.target.id;if(2==e.length?(c=Number(e.charAt(0)),d=Number(e.charAt(1))):(c=Number(e.charAt(1)),d=Number(e.charAt(2))),0==b.cols[d-1])b.cols[d-1]=c,b.rows[c-1]=d,b.moves++,b.drawRedBlocks(c,d),localStorage.setItem("moves",b.moves),localStorage.setItem("cols",b.cols),localStorage.setItem("rows",b.rows);else if(b.cols[d-1]==c)b.cols[d-1]=0,b.rows[c-1]=0,b.removeRedBlocks(c,d),b.moves++,localStorage.setItem("moves",b.moves),localStorage.setItem("cols",b.cols),localStorage.setItem("rows",b.rows);else{var f=b.cols[d-1];b.cols[d-1]=c,b.rows[c-1]=d,b.removeRedBlocks(f,d),b.moves++,localStorage.setItem("moves",b.moves),localStorage.setItem("cols",b.cols),localStorage.setItem("rows",b.rows)}},b.drawRedBlocks=function(a,c){var d,e,f;for(a--,c--,d=0;d<b.currentGrid;d++)for(f=Math.abs(d-c),b.redBlocks[b.currentGrid*a+d]=1,b.redBlocks[b.currentGrid*d+c]=1,e=0;e<b.currentGrid;e++)(e==a-f||e==a+f)&&(b.redBlocks[b.currentGrid*e+d]=1);b.redBlocks[b.currentGrid*a+c]=0},b.removeRedBlocks=function(a,c){var d,e;for(a--,c--,d=0;d<b.currentGrid;d++)for(0==b.cols[d]&&(b.redBlocks[b.currentGrid*a+d]=0,b.redBlocks[b.currentGrid*d+c]=0),e=0;e<b.currentGrid;e++)b.redBlocks[b.currentGrid*e+d]=0;for(d=0;d<b.currentGrid;d++)0!=b.cols[d]&&b.drawRedBlocks(b.cols[d],d+1)},b.init=function(){var a,c,d,e,f=Number(localStorage.getItem("gridSize")),g=null!=localStorage.getItem("cols")?localStorage.getItem("cols").split(",",f):null,h=null!=localStorage.getItem("rows")?localStorage.getItem("rows").split(",",f):null,i=Number(localStorage.getItem("moves"));if(null!=f&&null!=g&&null!=h&&null!=i){for(b.currentGrid=f,b.init_redBlocks(b.currentGrid),b.moves=i,b.cols=new Array(f),a=0;a<b.cols.length;a++)b.cols[a]=Number(g[a]),0!=b.cols[a]&&(c=b.cols[a],d=a+1,e=String(c)+String(d),b.drawRedBlocks(c,d));for(b.rows=new Array(f),a=0;a<b.rows.length;a++)b.rows[a]=Number(h[a])}else b.currentGrid=4,b.newGame()},b.init()}]),angular.module("ngQueensApp").directive("board",function(){return{restrict:"E",templateUrl:"views/board.html"}}),angular.module("ngQueensApp").run(["$templateCache",function(a){a.put("views/board.html",'<div ng-repeat="i in ctrl.getNumber(ctrl.currentGrid) track by i" class="board-row"> <div ng-repeat="j in ctrl.getNumber(ctrl.currentGrid) track by j" id="{{i}}{{j}}" class="tile-{{ctrl.currentGrid}}" ng-click="ctrl.moveQueen($event)" ng-class="{red: ctrl.redBlocks[ctrl.currentGrid*(i-1)+j-1] == 1}"> <img ng-if="ctrl.cols[j-1] == i" src="images/queen.3cf9eb09.png" class="queen-{{ctrl.currentGrid}}" id="Q{{i}}{{j}}"> </div> </div> <img ng-repeat="i in ctrl.getNumber(ctrl.currentGrid) track by i" src="images/queen.3cf9eb09.png" id="Q{{i}}" class="queen-{{ctrl.currentGrid}}" ng-class="{fade: ctrl.cols[{{i-1}}] != 0}">'),a.put("views/main.html",'<div id="content" ng-controller="MainController as ctrl"> <div id="heading" class="row"> <h1 class="title">ngQueens</h1> <div class="moves"> <h4>Moves</h4> <h4>{{ctrl.moves}}</h4> </div> </div> <div id="instructions" class="row"> <div class="txt"> Place all the queens on the board so that <br> no two queens threaten each other ! </div> <button class="restart-button" ng-click="ctrl.newGame()">New game</button> <div class="btn-group"> <button type="button" class="dropdown-toggle grid-button" data-toggle="dropdown"> Grid </button> <ul class="dropdown-menu"> <li><a ng-repeat="item in ctrl.gridSizes" ng-click="ctrl.changeGridSize(item.value)">{{ item.name }}</a></li> </ul> </div> </div> <div id="board-container"> <board></board> </div> </div>')}]);